<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Innioasis Updates and Custom Firmwares</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #495057;
        }

        .filter-group select {
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 14px;
            background: white;
            transition: border-color 0.3s ease;
        }

        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            align-self: end;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
        }

        .refresh-btn:active {
            transform: translateY(0);
        }

        .firmware-list {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .firmware-list h3 {
            margin-bottom: 20px;
            color: #495057;
            font-size: 1.3rem;
        }

        .firmware-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid #e9ecef;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .firmware-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .firmware-item.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #f8f9ff 0%, #f0f2ff 100%);
        }

        .firmware-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .firmware-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.8rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .detail-value {
            font-weight: 600;
            color: #495057;
        }

        .download-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .download-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .download-section {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .manual-install-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 0.9rem;
        }

        .manual-install-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(108, 117, 125, 0.3);
        }

        .automatic-install-btn {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            font-size: 0.9rem;
        }

        .automatic-install-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(23, 162, 184, 0.3);
        }

        .status {
            text-align: center;
            padding: 20px;
            background: #e8f5e8;
            border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid #a8e6cf;
        }

        .status.error {
            background: #fadbd8;
            border-color: #f5b7b1;
            color: #c0392b;
        }

        .status.loading {
            background: #fef9e7;
            border-color: #f8c471;
            color: #d68910;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            color: white;
            opacity: 0.8;
        }

        .footer a {
            color: white;
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .filters {
                grid-template-columns: 1fr;
            }
            
            .firmware-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔧 Y1 Helper Firmware Downloader</h1>
            <p>Download firmware releases directly from GitHub</p>
        </div>

        <div class="main-content">
            <div class="filters">
                <div class="filter-group">
                    <label for="deviceType">Device Type</label>
                    <select id="deviceType">
                        <option value="">All Types</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="deviceModel">Device Model</label>
                    <select id="deviceModel">
                        <option value="">All Models</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="software">Software</label>
                    <select id="software">
                        <option value="">All Software</option>
                    </select>
                </div>
                
                <button class="refresh-btn" onclick="refreshData()">
                    🔄 Refresh
                </button>
            </div>

            <div class="status" id="status">
                Ready to download firmware
            </div>

            <div class="firmware-list">
                <h3>Available Firmware</h3>
                <div id="firmwareContainer">
                    <p style="text-align: center; color: #6c757d;">Select filters and click refresh to load firmware</p>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Created by <a href="https://github.com/team-slide" target="_blank">Team Slide</a> | 
               <a href="https://github.com/team-slide/Y1-helper" target="_blank">GitHub</a></p>
        </div>
    </div>

    <script>
        // Global variables
        let packages = [];
        let currentFilters = {
            deviceType: '',
            deviceModel: '',
            software: ''
        };

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('deviceType').addEventListener('change', filterFirmware);
            document.getElementById('deviceModel').addEventListener('change', filterFirmware);
            document.getElementById('software').addEventListener('change', filterFirmware);
        }

        async function loadData() {
            try {
                setStatus('Loading configuration and manifest data...', 'loading');
                
                // Load manifest data
                const manifestResponse = await fetch('https://raw.githubusercontent.com/team-slide/slidia/refs/heads/main/slidia_manifest.xml');
                if (!manifestResponse.ok) {
                    throw new Error('Failed to load manifest');
                }
                
                const manifestText = await manifestResponse.text();
                packages = parseManifest(manifestText);
                
                if (packages.length === 0) {
                    throw new Error('No packages found in manifest');
                }
                
                console.log(`Loaded ${packages.length} software packages`);
                
                // Populate filters
                populateDeviceTypeCombo();
                populateDeviceModelCombo();
                populateSoftwareCombo();
                
                // Load initial firmware list
                await loadFirmwareList();
                
                setStatus('Ready to download firmware');
                
            } catch (error) {
                console.error('Error loading data:', error);
                setStatus(`Error loading data: ${error.message}`, 'error');
            }
        }

        function parseManifest(xmlText) {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
            const packageElements = xmlDoc.getElementsByTagName('package');
            
            const packages = [];
            for (let pkg of packageElements) {
                packages.push({
                    name: pkg.getAttribute('name') || 'Unknown',
                    device_type: pkg.getAttribute('device_type') || '',
                    repo: pkg.getAttribute('repo') || '',
                    device: pkg.getAttribute('device') || '',
                    url: pkg.getAttribute('url') || '',
                    type: pkg.getAttribute('type') || '',
                    handler: pkg.getAttribute('handler') || ''
                });
            }
            
            return packages;
        }

        function populateDeviceTypeCombo() {
            const combo = document.getElementById('deviceType');
            const deviceTypes = [...new Set(packages.map(p => p.device_type).filter(t => t))];
            
            combo.innerHTML = '<option value="">All Types</option>';
            deviceTypes.sort().forEach(type => {
                const option = document.createElement('option');
                option.value = type;
                option.textContent = `Type ${type}`;
                combo.appendChild(option);
            });
        }

        function populateDeviceModelCombo() {
            const combo = document.getElementById('deviceModel');
            const deviceModels = [...new Set(packages.map(p => p.device).filter(m => m))];
            
            combo.innerHTML = '<option value="">All Models</option>';
            deviceModels.sort().forEach(model => {
                const option = document.createElement('option');
                option.value = model;
                option.textContent = model;
                combo.appendChild(option);
            });
        }

        function populateSoftwareCombo() {
            const combo = document.getElementById('software');
            const softwareNames = [...new Set(packages.map(p => p.name).filter(n => n))];
            
            combo.innerHTML = '<option value="">All Software</option>';
            softwareNames.sort().forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                combo.appendChild(option);
            });
        }

        function filterFirmware() {
            currentFilters.deviceType = document.getElementById('deviceType').value;
            currentFilters.deviceModel = document.getElementById('deviceModel').value;
            currentFilters.software = document.getElementById('software').value;
            
            loadFirmwareList();
        }

        async function loadFirmwareList() {
            try {
                setStatus('Loading firmware releases...', 'loading');
                
                const container = document.getElementById('firmwareContainer');
                container.innerHTML = '<div class="loading-spinner"></div> Loading...';
                
                // Get filtered packages
                const filteredPackages = packages.filter(pkg => {
                    const typeMatch = !currentFilters.deviceType || pkg.device_type === currentFilters.deviceType;
                    const modelMatch = !currentFilters.deviceModel || pkg.device === currentFilters.deviceModel;
                    const softwareMatch = !currentFilters.software || pkg.name === currentFilters.software;
                    
                    return typeMatch && modelMatch && softwareMatch;
                });
                
                if (filteredPackages.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #6c757d;">No firmware found matching the selected filters</p>';
                    setStatus('No firmware found');
                    return;
                }
                
                // Load releases for each package
                const allReleases = [];
                for (const pkg of filteredPackages) {
                    try {
                        const releases = await getReleases(pkg.repo);
                        releases.forEach(release => {
                            release.software_name = pkg.name;
                            release.device_type = pkg.device_type;
                            release.device_model = pkg.device;
                            allReleases.push(release);
                        });
                    } catch (error) {
                        console.warn(`Failed to load releases for ${pkg.repo}:`, error);
                    }
                }
                
                // Sort releases by date (newest first)
                allReleases.sort((a, b) => new Date(b.published_at) - new Date(a.published_at));
                
                // Display releases
                displayFirmwareList(allReleases);
                setStatus(`Loaded ${allReleases.length} firmware releases`);
                
            } catch (error) {
                console.error('Error loading firmware list:', error);
                setStatus(`Error loading firmware: ${error.message}`, 'error');
                document.getElementById('firmwareContainer').innerHTML = 
                    '<p style="text-align: center; color: #c0392b;">Failed to load firmware list</p>';
            }
        }

        async function getReleases(repo) {
            try {
                const response = await fetch(`https://api.github.com/repos/${repo}/releases`);
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                
                const releases = await response.json();
                return releases.map(release => ({
                    tag_name: release.tag_name,
                    name: release.name || release.tag_name,
                    published_at: release.published_at,
                    html_url: release.html_url,
                    assets: release.assets || []
                }));
            } catch (error) {
                console.warn(`Failed to fetch releases for ${repo}:`, error);
                return [];
            }
        }

        function displayFirmwareList(releases) {
            const container = document.getElementById('firmwareContainer');
            
            if (releases.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6c757d;">No releases found</p>';
                return;
            }
            
            container.innerHTML = releases.map(release => `
                <div class="firmware-item" onclick="selectFirmware(this, '${release.software_name}')">
                    <div class="firmware-name">${release.software_name}</div>
                    <div class="firmware-details">
                        <div class="detail-item">
                            <div class="detail-label">Version</div>
                            <div class="detail-value">${release.tag_name}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Name</div>
                            <div class="detail-value">${release.name}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Published</div>
                            <div class="detail-value">${formatDate(release.published_at)}</div>
                        </div>
                        ${!currentFilters.deviceType ? `<div class="detail-item">
                            <div class="detail-label">Type</div>
                            <div class="detail-value">${release.device_type || 'N/A'}</div>
                        </div>` : ''}
                        ${!currentFilters.deviceModel ? `<div class="detail-item">
                            <div class="detail-label">Model</div>
                            <div class="detail-value">${release.device_model || 'N/A'}</div>
                        </div>` : ''}
                    </div>
                    <div class="download-section">
                        <button class="manual-install-btn" onclick="manualInstall('${release.html_url}', event)">
                            🔧 Manual Install
                        </button>
                        <button class="automatic-install-btn" onclick="automaticInstall('${release.software_name}', event)">
                            ⚡ Automatic Install
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function selectFirmware(element, softwareName) {
            // Remove previous selection
            document.querySelectorAll('.firmware-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Add selection to clicked item
            element.classList.add('selected');
        }





        function manualInstall(releasesUrl, event) {
            event.stopPropagation();
            
            // Show manual install guide dialog
            showManualInstallGuide(releasesUrl);
        }

        function showManualInstallGuide(releasesUrl) {
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                overflow-y: auto;
            `;
            
            dialog.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 15px;
                    padding: 30px;
                    max-width: 600px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                ">
                    <h2 style="color: #2c3e50; margin-bottom: 20px;">🔧 Manual Installation Guide</h2>
                    
                    <div style="margin-bottom: 25px;">
                        <button onclick="downloadROM('${releasesUrl}')" style="
                            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
                            color: white;
                            border: none;
                            padding: 15px 30px;
                            border-radius: 10px;
                            font-weight: 600;
                            font-size: 16px;
                            cursor: pointer;
                            transition: transform 0.2s ease;
                            margin-bottom: 20px;
                            width: 100%;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            📥 Download ROM
                        </button>
                        <p style="color: #6c757d; font-size: 14px; text-align: center;">
                            Download the ROM file first, then follow the installation guide for your operating system
                        </p>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #495057; margin-bottom: 15px;">Choose Your Operating System:</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button onclick="showPlatformGuide('windows')" style="
                                background: linear-gradient(135deg, #0078d4 0%, #106ebe 100%);
                                color: white;
                                border: none;
                                padding: 12px 20px;
                                border-radius: 8px;
                                font-weight: 500;
                                cursor: pointer;
                                transition: transform 0.2s ease;
                                text-align: left;
                            " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                                🪟 Windows Installation Guide
                            </button>
                            <button onclick="showPlatformGuide('mac')" style="
                                background: linear-gradient(135deg, #000000 0%, #333333 100%);
                                color: white;
                                border: none;
                                padding: 12px 20px;
                                border-radius: 8px;
                                font-weight: 500;
                                cursor: pointer;
                                transition: transform 0.2s ease;
                                text-align: left;
                            " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                                🍎 macOS Installation Guide
                            </button>
                            <button onclick="showPlatformGuide('linux')" style="
                                background: linear-gradient(135deg, #f47421 0%, #e95420 100%);
                                color: white;
                                border: none;
                                padding: 12px 20px;
                                border-radius: 8px;
                                font-weight: 500;
                                cursor: pointer;
                                transition: transform 0.2s ease;
                                text-align: left;
                            " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
                                🐧 Linux Installation Guide
                            </button>
                        </div>
                    </div>

                    <button onclick="closeManualInstallGuide()" style="
                        background: #6c757d;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 8px;
                        font-weight: 500;
                        cursor: pointer;
                        transition: background 0.3s ease;
                        width: 100%;
                    " onmouseover="this.style.background='#495057'" onmouseout="this.style.background='#6c757d'">
                        Close
                    </button>
                </div>
            `;
            
            document.body.appendChild(dialog);
        }

        function showPlatformGuide(platform) {
            const platformGuides = {
                windows: {
                    title: "🪟 Windows Installation Guide",
                    steps: [
                        "1. Download the ROM file using the Download ROM button above",
                        "2. Extract the ROM file from the downloaded archive",
                        "3. Install ADB (Android Debug Bridge) if not already installed",
                        "4. Enable Developer Options and USB Debugging on your device",
                        "5. Connect your device via USB cable",
                        "6. Open Command Prompt as Administrator",
                        "7. Navigate to the extracted ROM directory",
                        "8. Run the installation script or follow the README instructions",
                        "9. Follow any on-screen prompts during installation"
                    ],
                    additional: "For detailed instructions, visit the GitHub repository or use the Innioasis Updater for automatic installation."
                },
                mac: {
                    title: "🍎 macOS Installation Guide",
                    steps: [
                        "1. Download the ROM file using the Download ROM button above",
                        "2. Extract the ROM file from the downloaded archive",
                        "3. Install ADB using Homebrew: brew install android-platform-tools",
                        "4. Enable Developer Options and USB Debugging on your device",
                        "5. Connect your device via USB cable",
                        "6. Open Terminal",
                        "7. Navigate to the extracted ROM directory",
                        "8. Run the installation script or follow the README instructions",
                        "9. Follow any on-screen prompts during installation"
                    ],
                    additional: "For detailed instructions, visit the GitHub repository or use the Innioasis Updater for automatic installation."
                },
                linux: {
                    title: "🐧 Linux Installation Guide",
                    steps: [
                        "1. Download the ROM file using the Download ROM button above",
                        "2. Extract the ROM file from the downloaded archive",
                        "3. Install ADB: sudo apt install android-tools-adb (Ubuntu/Debian) or sudo dnf install android-tools (Fedora)",
                        "4. Enable Developer Options and USB Debugging on your device",
                        "5. Connect your device via USB cable",
                        "6. Open Terminal",
                        "7. Navigate to the extracted ROM directory",
                        "8. Run the installation script or follow the README instructions",
                        "9. Follow any on-screen prompts during installation"
                    ],
                    additional: "For detailed instructions, visit the GitHub repository or use the Innioasis Updater for automatic installation."
                }
            };

            const guide = platformGuides[platform];
            
            // Create platform-specific guide dialog
            const guideDialog = document.createElement('div');
            guideDialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1001;
                overflow-y: auto;
            `;
            
            guideDialog.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 15px;
                    padding: 30px;
                    max-width: 600px;
                    width: 90%;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                ">
                    <h2 style="color: #2c3e50; margin-bottom: 20px;">${guide.title}</h2>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #495057; margin-bottom: 15px;">Installation Steps:</h3>
                        <div style="
                            background: #f8f9fa;
                            border-radius: 10px;
                            padding: 20px;
                            margin-bottom: 20px;
                        ">
                            ${guide.steps.map(step => `
                                <p style="color: #495057; margin-bottom: 10px; line-height: 1.5;">${step}</p>
                            `).join('')}
                        </div>
                        <p style="color: #6c757d; font-size: 14px; line-height: 1.5;">
                            ${guide.additional}
                        </p>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <button onclick="closePlatformGuide()" style="
                            background: #6c757d;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 8px;
                            font-weight: 500;
                            cursor: pointer;
                            transition: background 0.3s ease;
                            flex: 1;
                        " onmouseover="this.style.background='#495057'" onmouseout="this.style.background='#6c757d'">
                            Back to Manual Install
                        </button>
                        <button onclick="closeAllDialogs()" style="
                            background: #dc3545;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 8px;
                            font-weight: 500;
                            cursor: pointer;
                            transition: background 0.3s ease;
                            flex: 1;
                        " onmouseover="this.style.background='#c82333'" onmouseout="this.style.background='#dc3545'">
                            Close All
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(guideDialog);
        }

        function downloadROM(releasesUrl) {
            // Open the GitHub releases page in a new tab for ROM download
            window.open(releasesUrl, '_blank');
        }

        function closeManualInstallGuide() {
            const dialog = document.querySelector('div[style*="position: fixed"]');
            if (dialog) {
                dialog.remove();
            }
        }

        function closePlatformGuide() {
            // Remove the platform guide dialog but keep the manual install guide
            const guideDialog = document.querySelector('div[style*="z-index: 1001"]');
            if (guideDialog) {
                guideDialog.remove();
            }
        }

        function closeAllDialogs() {
            // Remove all dialogs
            const dialogs = document.querySelectorAll('div[style*="position: fixed"]');
            dialogs.forEach(dialog => dialog.remove());
        }

        function automaticInstall(softwareName, event) {
            event.stopPropagation();
            
            // Show automatic install dialog
            showAutomaticInstallDialog(softwareName);
        }

        function showAutomaticInstallDialog(softwareName) {
            const dialog = document.createElement('div');
            dialog.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            dialog.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 15px;
                    padding: 30px;
                    max-width: 500px;
                    width: 90%;
                    text-align: center;
                    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
                ">
                    <h2 style="color: #2c3e50; margin-bottom: 20px;">⚡ Automatic Installation</h2>
                    <p style="color: #495057; margin-bottom: 25px; line-height: 1.6;">
                        For automatic installation of <strong>${softwareName}</strong>, you'll need the Innioasis Updater application.
                        This tool will handle the entire installation process automatically.
                    </p>
                    <div style="margin-bottom: 25px;">
                        <button onclick="downloadInnioasisUpdater()" style="
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            border: none;
                            padding: 15px 30px;
                            border-radius: 10px;
                            font-weight: 600;
                            font-size: 16px;
                            cursor: pointer;
                            transition: transform 0.2s ease;
                            margin-bottom: 15px;
                            width: 100%;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            📥 Download Innioasis Updater
                        </button>
                        <p style="color: #6c757d; font-size: 14px;">
                            This will open the latest release page in a new tab
                        </p>
                    </div>
                    <button onclick="closeAutomaticInstallDialog()" style="
                        background: #6c757d;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 8px;
                        font-weight: 500;
                        cursor: pointer;
                        transition: background 0.3s ease;
                    " onmouseover="this.style.background='#495057'" onmouseout="this.style.background='#6c757d'">
                        Close
                    </button>
                </div>
            `;
            
            document.body.appendChild(dialog);
        }

        function downloadInnioasisUpdater() {
            // Open the Innioasis Updater releases page in a new tab
            window.open('https://github.com/team-slide/Innioasis-Updater/releases/latest', '_blank');
        }

        function closeAutomaticInstallDialog() {
            const dialog = document.querySelector('div[style*="position: fixed"]');
            if (dialog) {
                dialog.remove();
            }
        }

        function formatDate(dateString) {
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch (error) {
                return dateString;
            }
        }

        function setStatus(message, type = '') {
            const statusElement = document.getElementById('status');
            statusElement.textContent = message;
            statusElement.className = `status ${type}`;
        }

        function refreshData() {
            loadData();
        }

        // Handle errors gracefully
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            setStatus('An unexpected error occurred', 'error');
        });

        // Handle unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled promise rejection:', e.reason);
            setStatus('Network or API error occurred', 'error');
        });
    </script>
</body>
</html>
